# Autogenerated config file for Metarank, source=./data/events.jsonl
#
# This config file may need to be edited manually:
# - persistence config is not defined. Metarank will run in an in-memory mode by default.
# - generated feature definitions for categories may include too many/few items.
# - model training hyperparameters may not be perfect for your dataset, so you may need to tune them.
#
  
models:
  default: 
    type: lambdamart
    features:
      - dislike
      - dislike_cnt
      - like 
      - like_cnt
  similar:
    type: als
    interactions:
    - dislike
    - like
    iterations: 100
    factors: 100
    userReg: 0.01
    itemReg: 0.01
    store:
      type: hnsw
      m: 32
      ef: 200
    selector:
      accept: true
  trending:
    type: trending
    weights:
    - interaction: dislike
      weight: 1.0
      decay: 1.0
      window: 30d
    - interaction: like
      weight: 1.0
      decay: 1.0
      window: 30d
    selector:
      accept: true

features:
  - type: interacted_with
    name: dislike
    interaction: dislike
    field:
    - item.content
    scope: user

  - type: number
    name: dislike_cnt
    field: item.dislike_cnt
    scope: item

  - type: interacted_with
    name: like
    interaction: like
    field:
    - item.content
    scope: user

  - type: number
    name: like_cnt
    field: item.like_cnt
    scope: item

# `#state:
# #  type: file
# #  path: /tmp/lmdb4/
# #  backend: mapdb
# #  type: redis
# #  host: localhost
# #  port: 6379
# #  format: binary
# #train:
# #  type: file
# #  path: /tmp/ctv
# #  format: binary

# core:
#   clickthrough:
#     maxSessionLength: 60s

# models:
#   similar:
#     type: als
#     interactions: [like, dislike]
#     factors: 100
#     iterations: 100000

#   trending:
#     type: trending
#     weights:
#       - interaction: like
#         decay: 2
#         weight: 100
#       - interaction: dislike
#         decay: 2
#         weight: 100

#   xgboost:
#     type: lambdamart
#     backend:
#       type: lightgbm
#       iterations: 500
#       ndcgCutoff: 10
#       seed: 0
#     weights:
#       like: 10
#       dislike: 10
#     features:
#       - like_cnt
#       - dislike_cnt
#       - tags
#       - ctr
#       - ctr_tag
#       - divers_like
#       - divers_dislike

# features:
#   - name: ctr
#     type: rate
#     top: like
#     bottom: impression
#     bucket: 24h
#     periods: [7, 30]
#     normalize:
#       weight: 100

#   - name: like_cnt
#     type: number
#     scope: item
#     source: metadata.like_cnt
#     normalize:
#       weight: 20

#   - name: dislike_cnt
#     type: number
#     scope: item
#     source: metadata.dislike_cnt
#     normalize:
#       weight: 20

#   - name: tags
#     type: diversity
#     source: item.tags

#   - name: ctr_tag
#     type: rate
#     top: like
#     bottom: impression
#     bucket: 24h
#     periods: [7,30]
#     scope: item.tag

#   - name: divers_like
#     type: diversity
#     source: item.like_cnt

#   - name: divers_dislike
#     type: diversity
#     source: item.dislike_cnt

#   - name: position
#     type: position
#     position: 5
# `